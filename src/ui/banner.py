#!/usr/bin/env python3

"""
Banner Class (banner.py)

Prints the banner for the application.
"""

import random
import time

from rich.console import Console
from rich.text import Text
from typing_extensions import LiteralString

BANNER = r"""
__________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________
______________/\\\\\\\\\\\\\\\____/\\\\\\\\\______/\\\\\\\\\\\_____/\\\\\\\\\_____/\\\____________________________________________________
______________\///////\\\/////___/\\\///////\\\___\/////\\\///____/\\\\\\\\\\\\\__\/\\\___________________________________________________
_____________________\/\\\_______\/\\\_____\/\\\_______\/\\\______/\\\/////////\\\_\/\\\__________________________________________________
______________________\/\\\_______\/\\\\\\\\\\\/________\/\\\_____\/\\\_______\/\\\_\/\\\_________________________________________________
_______________________\/\\\_______\/\\\//////\\\________\/\\\_____\/\\\\\\\\\\\\\\\_\/\\\________________________________________________
________________________\/\\\_______\/\\\____\//\\\_______\/\\\_____\/\\\/////////\\\_\/\\\_______________________________________________
_________________________\/\\\_______\/\\\_____\//\\\______\/\\\_____\/\\\_______\/\\\_\/\\\______________________________________________
__________________________\/\\\_______\/\\\______\//\\\__/\\\\\\\\\\\_\/\\\_______\/\\\_\/\\\\\\\\\\\\\\\_________________________________
___________________________\///________\///________\///__\///////////__\///________\///__\///////////////_________________________________
__________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________
_____/\\\\\\\\\\\____/\\\\\\\\\\\\\_________/\\\\\____________/\\\\\_______/\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\____/\\\\\\\\\_______________
____/\\\/////////\\\_\/\\\/////////\\\_____/\\\///\\\________/\\\///\\\____\/\\\///////////__\/\\\///////////___/\\\///////\\\____________
____\//\\\______\///__\/\\\_______\/\\\___/\\\/__\///\\\____/\\\/__\///\\\__\/\\\_____________\/\\\_____________\/\\\_____\/\\\___________
______\////\\\_________\/\\\\\\\\\\\\\/___/\\\______\//\\\__/\\\______\//\\\_\/\\\\\\\\\\\_____\/\\\\\\\\\\\_____\/\\\\\\\\\\\/___________
__________\////\\\______\/\\\/////////____\/\\\_______\/\\\_\/\\\_______\/\\\_\/\\\///////______\/\\\///////______\/\\\//////\\\__________
______________\////\\\___\/\\\_____________\//\\\______/\\\__\//\\\______/\\\__\/\\\_____________\/\\\_____________\/\\\____\//\\\________
________/\\\______\//\\\__\/\\\______________\///\\\__/\\\_____\///\\\__/\\\____\/\\\_____________\/\\\_____________\/\\\_____\//\\\______
________\///\\\\\\\\\\\/___\/\\\________________\///\\\\\/________\///\\\\\/_____\/\\\_____________\/\\\\\\\\\\\\\\\_\/\\\______\//\\\____
___________\///////////_____\///___________________\/////____________\/////_______\///______________\///////////////__\///________\///____
__________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________

"""  # noqa: E501, W291


class Banner:
    """
    Banner class for displaying the application banner with ASCII art.
    """

    def __init__(self, console: Console | None = None) -> None:
        """
        Initialize the Banner class.

        Args:
            console: Optional Rich Console instance. If None, creates a new one.
        """
        self.console = console or Console()

    def animate_banner(self, delay: float = 0.035) -> None:
        """
        Matrix-style animation where random characters morph into the banner.

        Args:
            delay: Delay between animation frames
        """
        self.console.print()

        banner_lines: list[LiteralString] = BANNER.strip().split("\n")
        matrix_chars = "01!@#$%^&*()_+-=[]|;:,.<>/?"

        # Create matrix version first
        matrix_lines: list[str] = []
        for line in banner_lines:
            matrix_line = ""
            for char in line:
                if char != " " and char != "_":
                    matrix_line += random.choice(seq=matrix_chars)
                else:
                    matrix_line += char
            matrix_lines.append(matrix_line)

        # Animate transformation
        for frame in range(15):  # 15 frames of animation
            self.console.clear()
            self.console.print()

            for _, line in enumerate[LiteralString](banner_lines):
                display_line: str = ""
                for _, char in enumerate[str](line):
                    if random.random() < (frame / 14):  # Gradually reveal
                        display_line += char
                    else:
                        if char != " " and char != "_":
                            display_line += random.choice(seq=matrix_chars)
                        else:
                            display_line += char

                line_text: Text = Text(text=display_line, style="bold cyan")
                self.console.print(line_text)

            time.sleep(delay)

        # Final reveal with cyan color
        self.console.clear()
        self.console.print()
        for line in banner_lines:
            self.console.print(Text(text=line, style="bold cyan"))
        self.console.print()
